<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buổi 5: Lập Trình Sockets TCP - Xây Dựng Kết Nối Tin Cậy</title>
    <link rel="stylesheet" href="https://DTStormBoBo.github.io/css/kawaii.min.css">
</head>
<body>
    <header>
        <h1>Buổi 5: Lập Trình Sockets TCP - Xây Dựng Kết Nối Tin Cậy</h1>
        <p><strong>Tags:</strong> Java, Networking, TCP, Socket, Client-Server | <strong>Categories:</strong> Lập Trình Mạng | <strong>Date:</strong> 2025-12-27</p>
        <p>Khám phá giao thức TCP, mô hình Client-Server và cách xây dựng ứng dụng mạng tin cậy bằng Java Socket.</p>
    </header>
    <main>
        <section>
            <h2>1. Mở đầu: Tại sao DevOps cần hiểu TCP?</h2>
            <p>Trong Buổi 4, chúng ta đã học cách tìm địa chỉ nhà (IP/DNS). Hôm nay, chúng ta sẽ học cách <strong>gõ cửa và nói chuyện</strong> với chủ nhà thông qua giao thức TCP.</p>
            <p>Trong thế giới DevOps, khi bạn debug lỗi "Connection Refused" hay cấu hình Load Balancer, bạn đang làm việc trực tiếp trên nền tảng của TCP.</p>
            <h3>TCP là gì?</h3>
            <p>TCP (Transmission Control Protocol) là giao thức hướng kết nối, đảm bảo độ tin cậy cao.</p>
            <ul>
                <li><strong>Không mất dữ liệu:</strong> Gói tin bị mất sẽ được gửi lại.</li>
                <li><strong>Đúng thứ tự:</strong> Dữ liệu đến nơi theo đúng trình tự gửi.</li>
                <li><strong>Kiểm soát luồng:</strong> Đảm bảo bên nhận không bị "ngộp" dữ liệu.</li>
            </ul>
            <p>Để thiết lập kết nối, TCP sử dụng quy trình <strong>Bắt tay 3 bước (Three-way handshake)</strong>: SYN -&gt; SYN-ACK -&gt; ACK.</p>
        </section>
        <section>
            <h2>2. Mô hình Client - Server</h2>
            <p>Mọi ứng dụng mạng TCP đều hoạt động dựa trên mô hình này.</p>
            <ol>
                <li><strong>Server (Máy chủ):</strong> Chạy trước, mở cổng (Port) và chờ đợi.</li>
                <li><strong>Client (Máy khách):</strong> Chạy sau, chủ động kết nối tới IP và Port của Server.</li>
                <li><strong>Giao tiếp:</strong> Hai bên truyền nhận dữ liệu qua luồng (Stream).</li>
            </ol>
        </section>
        <section>
            <h2>3. Lập trình TCP Socket trong Java</h2>
            <p>Java cung cấp 2 class chính trong gói <code>java.net</code> để xử lý TCP.</p>
            <h3>3.1. ServerSocket (Dành cho Server)</h3>
            <p>Class này dùng để tạo máy chủ và lắng nghe kết nối.</p>
            <ul>
                <li><strong>Khởi tạo:</strong> <code>ServerSocket(int port)</code> - Mở cổng để nghe.</li>
                <li><strong>Chấp nhận:</strong> <code>Socket accept()</code> - Chặn chương trình cho đến khi có Client kết nối. Trả về một đối tượng <code>Socket</code> để giao tiếp riêng với Client đó.</li>
            </ul>
            <h3>3.2. Socket (Dành cho Client &amp; Giao tiếp)</h3>
            <p>Class này đại diện cho một đầu mối kết nối (endpoint).</p>
            <ul>
                <li><strong>Khởi tạo (Client):</strong> <code>Socket(String host, int port)</code> - Kết nối tới Server.</li>
                <li><strong>Gửi dữ liệu:</strong> <code>OutputStream getOutputStream()</code>.</li>
                <li><strong>Nhận dữ liệu:</strong> <code>InputStream getInputStream()</code>.</li>
            </ul>
        </section>
        <section>
            <h2>4. Code Thực Chiến: Ứng dụng Echo Đơn Giản</h2>
            <p>Dưới đây là ví dụ cơ bản nhất: Client gửi lời chào, Server trả lời lại.</p>
            <h3>Code Server</h3>
            <pre><code class="language-java">import java.io.*;
import java.net.*;

public class SimpleServer {
    public static void main(String[] args) {
        try {
            // 1. Mở cổng 1234
            ServerSocket serverSocket = new ServerSocket(1234);
            System.out.println("Server đang lắng nghe tại cổng 1234...");

            // 2. Chờ Client kết nối (Blocking)
            Socket clientSocket = serverSocket.accept();
            System.out.println("Client đã kết nối!");

            // 3. Tạo luồng đọc/ghi
            BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
            PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);

            // 4. Nhận tin và trả lời
            String message = in.readLine(); // Đọc tin từ Client
            System.out.println("Client nói: " + message);
            
            out.println("Xin chào Client, Server đã nhận được tin!"); // Gửi lại

            // 5. Đóng kết nối
            serverSocket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}</code></pre>
            <h3>Code Client</h3>
            <pre><code class="language-java">import java.io.*;
import java.net.*;

public class SimpleClient {
    public static void main(String[] args) {
        try {
            // 1. Kết nối tới Server tại localhost:1234
            Socket socket = new Socket("localhost", 1234);

            // 2. Tạo luồng đọc/ghi
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            PrintWriter out = new PrintWriter(socket.getOutputStream(), true);

            // 3. Gửi tin nhắn tới Server
            out.println("Xin chào Server!");

            // 4. Nhận phản hồi từ Server
            String response = in.readLine();
            System.out.println("Server trả lời: " + response);

            // 5. Đóng kết nối
            socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}</code></pre>
        </section>
        <section>
            <h2>5. Bài Tập Tại Lớp: Oẳn Tù Tì v3</h2>
            <h3>Yêu cầu:</h3>
            <ol>
                <li>Viết tiếp chương trình <strong>Oẳn Tù Tì v2</strong> để hỗ trợ <strong>3 người chơi đồng thời</strong>.</li>
                <li>Sửa lỗi "Null" khi không có đủ người chơi hoặc khi kết nối bị gián đoạn.</li>
                <li>Cập nhật điểm số của từng người chơi sau mỗi lượt chơi.</li>
                <li>Hiển thị kết quả chi tiết của từng lượt chơi trên cả <strong>Server</strong> và <strong>Client</strong>.</li>
            </ol>
            <h3>Gợi ý triển khai:</h3>
            <ul>
                <li><strong>Server:</strong>
                    <ul>
                        <li>Sử dụng <strong>Thread</strong> để xử lý đồng thời kết nối từ 3 Client.</li>
                        <li>Quản lý trạng thái của từng người chơi (tên, điểm số, lựa chọn).</li>
                        <li>Xác định kết quả của mỗi lượt chơi và gửi thông báo đến từng Client.</li>
                    </ul>
                </li>
                <li><strong>Client:</strong>
                    <ul>
                        <li>Kết nối đến Server và gửi lựa chọn (Kéo, Búa, Bao).</li>
                        <li>Nhận kết quả từ Server và hiển thị trên màn hình.</li>
                    </ul>
                </li>
            </ul>
        </section>
        <section>
            <h2>6. Trắc Nghiệm Ôn Tập</h2>
            <h3>Câu hỏi:</h3>
            <ol>
                <li><strong>TCP</strong> là giao thức hướng kết nối. Điều này có nghĩa là gì?
                    <ul>
                        <li>A. Dữ liệu được truyền đi mà không cần xác nhận.</li>
                        <li>B. Kết nối phải được thiết lập trước khi truyền dữ liệu.</li>
                        <li>C. Dữ liệu được truyền đi theo từng gói nhỏ không theo thứ tự.</li>
                        <li>D. Không có cơ chế kiểm soát lỗi.</li>
                    </ul>
                    <p><strong>Đáp án:</strong> B</p>
                </li>
                <li>Phương thức nào trong lớp <code>ServerSocket</code> được sử dụng để chấp nhận kết nối từ Client?
                    <ul>
                        <li>A. <code>connect()</code></li>
                        <li>B. <code>accept()</code></li>
                        <li>C. <code>listen()</code></li>
                        <li>D. <code>bind()</code></li>
                    </ul>
                    <p><strong>Đáp án:</strong> B</p>
                </li>
                <li>Trong mô hình Client-Server, vai trò của Client là gì?
                    <ul>
                        <li>A. Lắng nghe kết nối từ Server.</li>
                        <li>B. Gửi yêu cầu dịch vụ đến Server.</li>
                        <li>C. Xử lý yêu cầu và trả kết quả.</li>
                        <li>D. Đóng kết nối khi không sử dụng.</li>
                    </ul>
                    <p><strong>Đáp án:</strong> B</p>
                </li>
            </ol>
        </section>
        <section>
            <h2>7. Thuyết Trình</h2>
            <h3>Chủ đề:</h3>
            <ul>
                <li><strong>Ứng dụng thực tế của TCP trong lập trình mạng.</strong></li>
                <li><strong>So sánh TCP và UDP: Khi nào nên sử dụng?</strong></li>
                <li><strong>Thách thức và giải pháp khi lập trình ứng dụng mạng với TCP.</strong></li>
            </ul>
        </section>
        <section>
            <h2>8. Hỏi &amp; Đáp</h2>
            <h3>Một số câu hỏi gợi ý:</h3>
            <ol>
                <li>Làm thế nào để xử lý lỗi "Connection Refused" khi kết nối TCP?</li>
                <li>Tại sao cần sử dụng <code>try-catch</code> khi làm việc với <code>Socket</code> và <code>ServerSocket</code>?</li>
                <li>Làm thế nào để tối ưu hiệu suất khi xử lý nhiều kết nối đồng thời trên Server?</li>
            </ol>
            <p><strong>Enjoy Learning!</strong></p>
            <p>Hãy tiếp tục khám phá và thực hành để nắm vững kiến thức về lập trình mạng. Chúc các bạn học tốt và thành công!</p>
        </section>
    </main>
</body>
</html>
